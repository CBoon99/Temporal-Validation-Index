<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Universal Impact Calculator â€¢ TVI System</title>
  <meta name="description" content="TVI (Temporal Validation Index) â€” proprietary framework for measuring long-term cultural impact, brand value, media effectiveness, and investment staying power. Patent-pending analytical system.">
  <link rel="canonical" href="https://tvi-framework.com/universal-impact-calculator.html">
  
  <!-- Open Graph / Social -->
  <meta property="og:title" content="TVI Platform - Temporal Validation Index">
  <meta property="og:description" content="Measure what will last. TVI quantifies long-term brand impact, cultural measurement, media valuation, and investment staying power. Proprietary, patent-pending analytical framework.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://tvi-framework.com/universal-impact-calculator.html">
  <meta name="twitter:url" content="https://tvi-framework.com/universal-impact-calculator.html">
  <meta property="og:image" content="/assets/book-cover.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="TVI Platform - Measure What Will Last">
  <meta name="twitter:description" content="Quantify long-term brand impact, cultural measurement, and media effectiveness. Proprietary temporal validation framework for investment and marketing analytics.">
  <meta name="twitter:image" content="/assets/book-cover.png">
  
  <!-- Schema.org -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "TVI Platform",
    "applicationCategory": "BusinessApplication",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD",
      "description": "Demonstrative calculator for evaluation purposes. Commercial licensing required for operational use."
    },
    "description": "Temporal Validation Index - proprietary framework for measuring long-term brand impact, cultural measurement, media valuation, and investment staying power. Patent-pending analytical system.",
    "provider": {
      "@type": "Organization",
      "name": "BoonMind Analytics"
    }
  }
  </script>
  
  <link rel="icon" href="/assets/icons/favicon.svg">
  <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/favicon.svg">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#05070d">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@400;600;700;800;900&family=Inter:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg0:#05070d;
      --bg1:#070b16;
      --bg2:#0a1024;

      --surface: rgba(255,255,255,0.04);
      --surface-2: rgba(255,255,255,0.06);
      --border: rgba(255,255,255,0.10);
      --border-subtle: rgba(255,255,255,0.08);

      --text:#ffffff;
      --text-2: rgba(255,255,255,0.78);
      --text-3: rgba(255,255,255,0.52);

      /* Primary accent */
      --accent:#2ce0ff;
      --accent-dim: rgba(44,224,255,0.10);

      /* Domain accents (for dots/badges only) */
      --ai:#22d3ee;
      --business:#fbbf24;
      --invest:#a3e635;
      --culture:#a78bfa;

      --success:#34d399;
      --error:#fb7185;

      --radius:16px;
      --radius-sm:12px;
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Inter', system-ui, sans-serif;
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(44,224,255,0.10), transparent 60%),
        radial-gradient(900px 700px at 100% 10%, rgba(167,139,250,0.08), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 55%, var(--bg2));
      color: var(--text);
      line-height: 1.5;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 80px 32px;
      padding-bottom: calc(120px + var(--safe-bottom));
    }

    /* Header */
    header {
      text-align: center;
      padding: 32px 0 24px;
      border-bottom: 1px solid var(--border-subtle);
      margin-bottom: 24px;
    }
    header h1 {
      font-family: 'Inter Tight', system-ui, sans-serif;
      font-size: clamp(36px, 5vw, 64px);
      font-weight: 800;
      letter-spacing: -0.03em;
      margin-bottom: 6px;
      text-shadow: 0 0 24px rgba(44,224,255,0.12);
    }
    header p {
      font-size: 14px;
      color: var(--text-2);
    }
    .version {
      display: inline-block;
      font-size: 10px;
      font-family: 'Space Mono', monospace;
      color: var(--text-3);
      background: var(--surface);
      padding: 4px 8px;
      border-radius: 4px;
      margin-top: 12px;
    }

    /* Nav Tabs */
    .nav-tabs {
      display: flex;
      gap: 4px;
      background: var(--surface);
      padding: 4px;
      border-radius: var(--radius);
      margin-bottom: 24px;
    }
    .nav-tab {
      flex: 1;
      padding: 10px 12px;
      background: transparent;
      border: none;
      border-radius: var(--radius-sm);
      color: var(--text-3);
      font-size: 13px;
      font-weight: 500;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.15s;
    }
    .nav-tab:hover { color: var(--text-2); }
    .nav-tab.active {
      background: var(--surface-2);
      color: var(--text);
    }

    /* Typography accents */
    .section-title,
    .card-header h2,
    .domain-btn div:first-child {
      font-family: 'Inter Tight', system-ui, sans-serif;
      letter-spacing: -0.02em;
    }
    .brand {
      font-family: "Inter Tight", system-ui;
      font-weight: 800;
      letter-spacing: -0.04em;
      text-transform: none;
      text-shadow: 0 0 24px rgba(44,224,255,.12);
      line-height: 1.05;
    }
    .mark-row{
      display:flex;
      justify-content:flex-start;
      align-items:center;
      gap:14px;
      margin-bottom:14px;
    }
    .mark{width:60px;height:60px;opacity:0.95}
    .wordmark .wm-top{
      font-family:'Inter Tight',system-ui;
      font-weight:900;
      letter-spacing:-0.03em;
      font-size:18px;
    }
    .wordmark .wm-sub{
      font-size:14px;
      color:var(--text-2);
      margin-top:-2px;
      letter-spacing:-0.01em;
    }
    .mono,
    .version,
    .result-score .value,
    .component .val {
      font-family: 'Space Mono', monospace;
    }

    /* Domain Selector */
    .domain-selector {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-bottom: 24px;
    }
    .domain-btn {
      padding: 16px 8px;
      background: var(--surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius);
      color: var(--text-2);
      font-size: 12px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.15s;
      text-align: center;
    }
    .domain-btn:hover {
      border-color: var(--border);
      color: var(--text);
    }
    .domain-btn.active {
      background: var(--accent-dim);
      border-color: var(--accent);
      color: var(--text);
    }

    .domain-icon {
      width: 32px;
      height: 32px;
      margin: 0 auto 12px;
      filter: brightness(0) invert(1);
      opacity: 0.85;
    }
    .domain-btn:hover .domain-icon {
      opacity: 1;
      filter: brightness(0) invert(1) drop-shadow(0 0 8px rgba(44,224,255,0.4));
    }
    .domain-btn.active .domain-icon {
      filter: brightness(0) saturate(100%) invert(70%) sepia(100%) saturate(500%) hue-rotate(160deg);
    }

    /* Compare icons */
    .compare-icon {
      width: 48px;
      height: 48px;
      object-fit: contain;
      margin-bottom: 8px;
      filter: brightness(0) invert(1);
      opacity: 0.9;
      transition: 0.2s ease;
      pointer-events: none;
    }
    .compare-icon:hover {
      transform: scale(1.05);
      opacity: 1;
      filter: brightness(0) invert(1) drop-shadow(0 2px 12px rgba(44,224,255,0.3));
    }
    .compare-item.selected .compare-icon {
      filter: brightness(0) saturate(100%) invert(70%) sepia(100%) saturate(500%) hue-rotate(160deg);
    }

    /* Sections */
    .section { display: block; }
    .page-section{scroll-margin-top:24px;padding-top:10px;}

    /* Card */
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.01));
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: var(--radius);
      margin-bottom: 16px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.5);
    }
    .card-header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border-subtle);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .card-header h2 {
      font-size: 15px;
      font-weight: 600;
    }
    .card-body { padding: 20px; }

    /* Presets */
    .presets {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    .preset {
      padding: 6px 12px;
      background: var(--surface-2);
      border: 1px solid var(--border-subtle);
      border-radius: 999px;
      color: var(--text-2);
      font-size: 12px;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.15s;
    }
    .preset:hover {
      border-color: var(--accent);
      color: var(--text);
    }

    /* Form */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .form-group { display: flex; flex-direction: column; }
    .form-group.full { grid-column: 1 / -1; }
    .form-group label {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-2);
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .form-group label .req { color: var(--error); }
    .form-group input,
    .form-group select {
      padding: 10px 12px;
      background: var(--bg1);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text);
      font-size: 14px;
      font-family: inherit;
      outline: none;
      transition: border-color 0.15s;
    }
    .form-group input:focus,
    .form-group select:focus {
      border-color: var(--accent);
    }
    .form-group input.error {
      border-color: var(--error);
    }
    .form-group input::placeholder { color: var(--text-3); }
    .form-group select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2371717a' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
    }
    .form-group .hint {
      font-size: 11px;
      color: var(--text-3);
      margin-top: 4px;
    }
    .form-group .error-msg {
      font-size: 11px;
      color: var(--error);
      margin-top: 4px;
      display: none;
    }
    .form-group .error-msg.show { display: block; }

    /* Slider */
    .slider-row {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    .slider-row input[type="range"] {
      flex: 1;
      height: 4px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--surface-2);
      border-radius: 2px;
      border: none;
      padding: 0;
    }
    .slider-row input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
    }
    .slider-row input[type="number"] {
      width: 70px;
      text-align: center;
      font-family: 'Space Mono', monospace;
      font-size: 13px;
    }

    /* Section Label */
    .section-label {
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-3);
      margin: 20px 0 12px;
    }
    .section-label:first-child { margin-top: 0; }

    /* Button */
    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 14px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.15s;
    }
    .btns {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .btn-primary {
      width: 100%;
      background: linear-gradient(135deg, rgba(44,224,255,0.22), rgba(44,224,255,0.08));
      border:1px solid rgba(44,224,255,0.35);
      color: var(--text);
      margin-top: 20px;
      font-weight: 800;
      letter-spacing: 0.02em;
      text-transform: none;
      box-shadow: 0 14px 40px rgba(0,0,0,0.45);
    }
    .btn-primary:hover{
      transform: translateY(-1px);
      border-color: rgba(44,224,255,0.6);
      box-shadow: 0 18px 60px rgba(44,224,255,0.12);
    }
    .btn-primary:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
    .btn-secondary {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.2);
      color: var(--text);
    }
    .btn-secondary:hover {
      border-color: var(--accent);
      color: var(--text);
    }
    .btn-ghost {
      background: transparent;
      color: var(--text-3);
      padding: 8px 12px;
      font-size: 12px;
    }
    .btn-ghost:hover { color: var(--text-2); }

    /* Results */
    .results { display: none; }
    .results.show { display: block; }
    .result-score {
      text-align: center;
      padding: 32px 20px;
    }
    .result-score .label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-3);
      margin-bottom: 8px;
    }
    .result-score .value {
      font-size: 56px;
      font-weight: 700;
      font-family: 'Space Mono', monospace;
      color: var(--text);
      line-height: 1;
    }
    .result-score .name {
      font-size: 16px;
      font-weight: 600;
      color: var(--text);
      margin-top: 16px;
    }
    .result-score .year {
      font-size: 13px;
      color: var(--text-3);
    }
    .result-badge {
      display: inline-block;
      padding: 8px 16px;
      background: var(--accent-dim);
      border: 1px solid var(--accent);
      border-radius: 999px;
      font-size: 13px;
      font-weight: 600;
      color: var(--accent);
      margin-top: 16px;
    }
    .result-components {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      padding: 20px;
      border-top: 1px solid var(--border-subtle);
    }
    .component {
      text-align: center;
      padding: 12px;
      background: var(--bg1);
      border-radius: var(--radius-sm);
    }
    .component .val {
      font-size: 20px;
      font-weight: 600;
      font-family: 'Space Mono', monospace;
    }
    .component .lbl {
      font-size: 10px;
      color: var(--text-3);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }
    .result-actions {
      display: flex;
      gap: 8px;
      padding: 16px 20px;
      border-top: 1px solid var(--border-subtle);
    }
    .result-actions .btn { flex: 1; }

    /* Info Page */
    .info-content { padding: 20px; }
    .info-content h3 {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 12px;
    }
    .info-content p {
      font-size: 14px;
      color: var(--text-2);
      margin-bottom: 16px;
      line-height: 1.7;
    }
    .info-content .formula {
      font-family: 'Space Mono', monospace;
      font-size: 14px;
      background: var(--bg1);
      padding: 16px;
      border-radius: var(--radius-sm);
      color: var(--accent);
      margin: 16px 0;
      text-align: center;
    }
    .info-content ul {
      margin: 16px 0;
      padding-left: 20px;
    }
    .info-content li {
      font-size: 14px;
      color: var(--text-2);
      margin-bottom: 8px;
    }
    .info-content li strong { color: var(--text); }
    .highlight-box {
      background: var(--accent-dim);
      border-left: 3px solid var(--accent);
      padding: 16px;
      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
      margin: 20px 0;
    }
    .highlight-box p { margin: 0; }

    /* TVI diagram hard size clamp */
    .tvi-diagram,
    .tvi-diagram img {
      width: 100%;
      max-width: 520px;
      height: auto;
      display: block;
      margin: 24px auto;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.25);
      /* Unified filter: subtle darken + neutralize beige tones */
      filter: brightness(0.92) contrast(0.88) saturate(0.80);
      background: rgba(245, 242, 238, 0.2);
      padding: 8px;
      box-sizing: border-box;
    }
    
    /* Legacy class for any remaining references */
    .framework-visual {
      width: 100%;
      max-width: 900px;
      height: auto;
      display: block;
      margin: 20px auto;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.25);
    }
    .framework-visual-caption {
      text-align: center;
      font-size: 12px;
      color: var(--text-3);
      margin-top: 8px;
      font-style: italic;
    }

    /* Compare */
    .compare-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 16px;
    }
    .compare-item {
      padding: 16px;
      background: var(--bg1);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius);
      text-align: center;
      cursor: pointer;
      transition: all 0.15s;
    }
    .compare-item:hover {
      border-color: var(--border);
    }
    .compare-item.selected {
      border-color: var(--accent);
      background: var(--accent-dim);
    }
    .compare-item .icon { font-size: 24px; margin-bottom: 8px; pointer-events: none; }
    .compare-item .name { font-size: 13px; font-weight: 600; pointer-events: none; }
    .compare-item .meta { font-size: 11px; color: var(--text-3); pointer-events: none; }
    .compare-vs {
      text-align: center;
      font-size: 14px;
      font-weight: 700;
      color: var(--text-3);
      padding: 8px 0;
    }
    .compare-result {
      display: none;
      text-align: center;
      padding: 24px;
      background: var(--accent-dim);
      border-radius: var(--radius);
      margin-top: 16px;
    }
    .compare-result.show { display: block; }
    .compare-result .winner {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 12px;
    }
    .compare-result .scores {
      display: flex;
      justify-content: center;
      gap: 32px;
      margin-bottom: 12px;
    }
    .compare-result .score-item .val {
      font-size: 24px;
      font-weight: 700;
      font-family: 'Space Mono', monospace;
    }
    .compare-result .score-item .lbl {
      font-size: 11px;
      color: var(--text-3);
    }
    .compare-result .insight {
      font-size: 13px;
      color: var(--text-2);
      max-width: 400px;
      margin: 0 auto;
    }

    /* Contact */
    .contact-form { padding: 20px; }
    .contact-form h3 {
      font-size: 18px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 8px;
    }
    .contact-form .intro {
      font-size: 13px;
      color: var(--text-2);
      text-align: center;
      margin-bottom: 24px;
    }
    .contact-form textarea {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg1);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text);
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      min-height: 100px;
      outline: none;
    }
    .contact-form textarea:focus { border-color: var(--accent); }

    /* Footer */
    footer {
      text-align: center;
      padding: 24px;
      border-top: 1px solid var(--border-subtle);
      margin-top: 24px;
    }
    footer .ver {
      font-family: 'Space Mono', monospace;
      font-size: 11px;
      color: var(--text-3);
    }
    footer p {
      font-size: 12px;
      color: var(--text-3);
      margin-top: 8px;
    }
    footer a { color: var(--accent); text-decoration: none; }

    /* Toast */
    .toast {
      position: fixed;
      bottom: calc(20px + var(--safe-bottom));
      left: 50%;
      transform: translateX(-50%) translateY(80px);
      background: var(--surface);
      border: 1px solid var(--border);
      padding: 12px 20px;
      border-radius: var(--radius-sm);
      font-size: 13px;
      opacity: 0;
      transition: all 0.2s;
      z-index: 1000;
    }
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    /* Mobile */
    @media (max-width: 768px) {
      .tvi-diagram,
      .tvi-diagram img {
        max-width: 92vw;
        margin: 20px auto;
      }
    }

    @media (max-width: 600px) {
      .domain-selector { grid-template-columns: repeat(2, 1fr); }
      .form-grid { grid-template-columns: 1fr; }
      .result-components { grid-template-columns: 1fr; }
      .result-actions {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--surface);
        border-top: 1px solid var(--border);
        padding-bottom: calc(16px + var(--safe-bottom));
        z-index: 50;
      }
      .compare-grid { grid-template-columns: 1fr; }
      .framework-visual {
        max-width: 100%;
        margin: 20px auto;
        border-radius: var(--radius-sm);
      }
      .framework-visual-caption {
        font-size: 11px;
        padding: 0 8px;
      }
      .info-content {
        padding: 16px;
      }
      .info-content h3 {
        font-size: 16px;
      }
    }
  </style>
  <script src="js/tvi-engine.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <div class="mark-row">
        <img src="assets/icons/tvi-mark.svg" alt="TVI mark" class="mark"/>
        <div class="wordmark">
          <div class="wm-top">TVI</div>
          <div class="wm-sub">Temporal Validation Index</div>
        </div>
      </div>
      <h1>Measure what will last.</h1>
      <p>A universal index for cultural, data, and economic staying power.</p>
      <p style="color:var(--text-2);margin-top:8px;">Most metrics measure attention. TVI measures what survives.</p>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin:14px 0;">
        <button class="btn btn-primary" onclick="document.getElementById('sec-calc').scrollIntoView({behavior:'smooth'})">Run a TVI</button>
        <button class="btn btn-secondary" style="padding:10px 12px;" onclick="document.getElementById('sec-about').scrollIntoView({behavior:'smooth'})">See how it works â†’</button>
      </div>
      <p style="font-size:13px;color:var(--text-3);margin-top:8px;"><a href="#sec-contact" style="color:var(--accent);text-decoration:none;">Get the book drop + updates (no spam)</a></p>
      <div style="margin-top:6px;font-size:13px;color:var(--text-2);">
        TVI (Temporal Validation Index) quantifies whether something is becoming a foundation â€” or just passing through.
      </div>
      <div style="display:flex; gap:10px; justify-content:center; margin-top:20px;">
        <button class="btn btn-secondary auth-btn login-btn" onclick="showLoginModal()" style="display:none;">Sign in</button>
        <button class="btn btn-ghost auth-btn logout-btn" onclick="logout()" style="display:none;">Logout</button>
      </div>
      <span class="version">v1.0.1</span>
    </header>

    <div class="mini-nav" style="display:flex;gap:10px;justify-content:center;margin:16px 0 28px;flex-wrap:wrap;">
      <button class="btn btn-secondary" style="width:auto;padding:10px 14px;" onclick="document.getElementById('landing-pages').scrollIntoView({behavior:'smooth'})">Domains</button>
      <button class="btn btn-secondary" style="width:auto;padding:10px 14px;" onclick="document.getElementById('sec-calc').scrollIntoView({behavior:'smooth'})">Run TVI</button>
      <button class="btn btn-secondary" style="width:auto;padding:10px 14px;" onclick="document.getElementById('sec-about').scrollIntoView({behavior:'smooth'})">How it works</button>
      <button class="btn btn-secondary" style="width:auto;padding:10px 14px;" onclick="window.location.href='/research/index.html'">Research</button>
      <button class="btn btn-secondary" style="width:auto;padding:10px 14px;" onclick="window.location.href='/book.html'">Book</button>
    </div>

    <!-- Landing Pages System -->
    <section class="section page-section" id="landing-pages">
      <div style="display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));">
        <div class="card">
          <div class="card-body">
            <div class="section-label">AI &amp; Data</div>
            <h3>Which datasets become infrastructure?</h3>
            <p style="color:var(--text-2);margin-top:6px;">Teams pick on downloads, stars, and recency â†’ brittle models, benchmark chasing, silent dataset decay.</p>
            <p style="margin-top:8px;">TVI shows whether a dataset is becoming a default â€” or being quietly replaced.</p>
            <ul style="margin:12px 0 0 16px;color:var(--text-2);font-size:13px;line-height:1.5;">
              <li>MNIST vs CIFAR vs ImageNet â€” lower downloads, higher temporal persistence.</li>
              <li>Why some datasets survive 20+ years.</li>
            </ul>
            <div class="btns" style="margin-top:14px;">
              <button class="btn btn-primary" onclick="selectDomain('datasets')">Run TVI on your dataset</button>
              <button class="btn btn-secondary" onclick="downloadSampleReport('TVI-Report-Datasets')">Download Sample TVI Report</button>
              <button class="btn btn-secondary" onclick="document.getElementById('sec-about').scrollIntoView({behavior:'smooth'})">See how it works â†’</button>
            </div>
            <p style="font-size:11px;color:var(--text-3);margin-top:10px;font-style:italic;">Example output generated using the BoonMind TVI engine.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <div class="section-label">Business Methods</div>
            <h3>Stop betting your company on fads.</h3>
            <p style="color:var(--text-2);margin-top:6px;">Holacracy, OKRs, SAFe, Spotify get adopted because others did â€” not because they last.</p>
            <p style="margin-top:8px;">TVI-B shows which frameworks compound and which decay after consulting hype.</p>
            <ul style="margin:12px 0 0 16px;color:var(--text-2);font-size:13px;line-height:1.5;">
              <li>Agile vs Holacracy</li>
              <li>Lean vs Growth Hacking</li>
              <li>SMART vs OKRs â€” time exposes the difference.</li>
            </ul>
            <div class="btns" style="margin-top:14px;">
              <button class="btn btn-primary" onclick="selectDomain('business')">Evaluate your framework</button>
              <button class="btn btn-secondary" onclick="downloadSampleReport('TVI-Report-Business')">Download Sample TVI Report</button>
              <button class="btn btn-secondary" onclick="document.getElementById('sec-about').scrollIntoView({behavior:'smooth'})">See how it works â†’</button>
            </div>
            <p style="font-size:11px;color:var(--text-3);margin-top:10px;font-style:italic;">Example output generated using the BoonMind TVI engine.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <div class="section-label">Investments</div>
            <h3>Momentum lies. Time doesnâ€™t.</h3>
            <p style="color:var(--text-2);margin-top:6px;">Markets price growth, buzz, and stories â€” not durability, category control, or crisis survival.</p>
            <p style="margin-top:8px;">ISPS shows which companies are becoming foundations, not just riding cycles.</p>
            <ul style="margin:12px 0 0 16px;color:var(--text-2);font-size:13px;line-height:1.5;">
              <li>Apple vs Nokia</li>
              <li>Amazon vs Pets.com</li>
              <li>Crypto cycles.</li>
            </ul>
            <div class="btns" style="margin-top:14px;">
              <button class="btn btn-primary" onclick="selectDomain('invest')">Run a Staying Power analysis</button>
              <button class="btn btn-secondary" onclick="downloadSampleReport('TVI-Report-Invest')">Download Sample TVI Report</button>
              <button class="btn btn-secondary" onclick="document.getElementById('sec-about').scrollIntoView({behavior:'smooth'})">See how it works â†’</button>
            </div>
            <p style="font-size:11px;color:var(--text-3);margin-top:10px;font-style:italic;">Example output generated using the BoonMind TVI engine.</p>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <div class="section-label">Culture &amp; Media</div>
            <h3>Virality is cheap. Cultural memory is rare.</h3>
            <p style="color:var(--text-2);margin-top:6px;">Impressions, reach, and clicks ignore what becomes canon vs what disappears.</p>
            <p style="margin-top:8px;">TVI shows which ideas become reference points â€” and which fade.</p>
            <ul style="margin:12px 0 0 16px;color:var(--text-2);font-size:13px;line-height:1.5;">
              <li>A 1990 song vs a TikTok hit.</li>
              <li>A meme that lasted vs one that didnâ€™t.</li>
            </ul>
            <div class="btns" style="margin-top:14px;">
              <button class="btn btn-primary" onclick="selectDomain('viral')">Analyze cultural impact</button>
              <button class="btn btn-secondary" onclick="downloadSampleReport('TVI-Report-Viral')">Download Sample TVI Report</button>
              <button class="btn btn-secondary" onclick="document.getElementById('sec-about').scrollIntoView({behavior:'smooth'})">See how it works â†’</button>
            </div>
            <p style="font-size:11px;color:var(--text-3);margin-top:10px;font-style:italic;">Example output generated using the BoonMind TVI engine.</p>
          </div>
        </div>
      </div>
    </section>

    <nav class="nav-tabs">
      <button class="nav-tab" onclick="document.getElementById('sec-calc').scrollIntoView({behavior:'smooth'})">Calculator</button>
      <button class="nav-tab" onclick="document.getElementById('sec-about').scrollIntoView({behavior:'smooth'})">What is TVI?</button>
      <button class="nav-tab" onclick="document.getElementById('sec-compare').scrollIntoView({behavior:'smooth'})">Compare</button>
      <button class="nav-tab" onclick="document.getElementById('sec-contact').scrollIntoView({behavior:'smooth'})">Contact</button>
    </nav>

    <!-- CALCULATOR -->
    <section class="section page-section" id="sec-calc">
      <div style="margin-bottom:16px;">
        <div style="font-size:16px;font-weight:700;">Give us the facts. We'll do the time math.</div>
        <div style="font-size:12px;color:var(--text-2);margin-top:6px;">TVI adjusts for era, saturation, and resistance so you don't mistake noise for permanence.</div>
        <div style="background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:16px;margin-top:16px;">
          <p style="margin:0;font-size:12px;line-height:1.5;color:var(--text-2);">
            <strong style="color:var(--text);">Important:</strong> Calculator outputs are illustrative and designed for pattern recognition and long-horizon comparison. They are not licensed for commercial decision-making, investment advice, or operational use. For commercial applications, evaluation access, or licensed deployment, please contact us below.
          </p>
        </div>
      </div>
      <div class="domain-selector">
        <button class="domain-btn active" data-domain="viral">
          <img src="assets/icons/icon-domain-culture.svg" alt="" class="domain-icon">
          <div style="font-weight:700;">Culture &amp; Media</div>
          <div style="font-size:11px;color:var(--text-3);margin-top:4px;">Will this idea still be referenced when the algorithm moves on?</div>
          <div style="font-size:11px;color:var(--text-2);margin-top:2px;">TVI reveals if itâ€™s entering the cultural canon â€” or just trending.</div>
        </button>
        <button class="domain-btn" data-domain="datasets">
          <img src="assets/icons/icon-domain-ai.svg" alt="" class="domain-icon">
          <div style="font-weight:700;">AI &amp; Data</div>
          <div style="font-size:11px;color:var(--text-3);margin-top:4px;">Which datasets, models, and standards will still matter in five years?</div>
          <div style="font-size:11px;color:var(--text-2);margin-top:2px;">TVI reveals if a dataset is becoming infrastructure â€” or being quietly replaced.</div>
        </button>
        <button class="domain-btn" data-domain="business">
          <img src="assets/icons/icon-domain-business.svg" alt="" class="domain-icon">
          <div style="font-weight:700;">Business Methods</div>
          <div style="font-size:11px;color:var(--text-3);margin-top:4px;">Is this framework a management standard â€” or a consulting fad?</div>
          <div style="font-size:11px;color:var(--text-2);margin-top:2px;">TVI reveals which methodologies compound value over decades, and which decay after hype.</div>
        </button>
        <button class="domain-btn" data-domain="invest">
          <img src="assets/icons/icon-domain-invest.svg" alt="" class="domain-icon">
          <div style="font-weight:700;">Investments</div>
          <div style="font-size:11px;color:var(--text-3);margin-top:4px;">Is this company building a category â€” or riding a cycle?</div>
          <div style="font-size:11px;color:var(--text-2);margin-top:2px;">TVI reveals whether a business has real temporal advantage, not just market momentum.</div>
        </button>
      </div>

      <!-- Viral Form -->
      <div class="form-section" id="form-viral">
        <div class="card">
          <div class="card-header">
            <h2>Viral Content</h2>
            <button class="btn-ghost" onclick="resetForm('viral')">Reset</button>
          </div>
          <div class="card-body">
            <div class="presets">
              <button class="preset" onclick="loadPreset('viral','charlie')">Charlie Bit My Finger</button>
              <button class="preset" onclick="loadPreset('viral','gangnam')">Gangnam Style</button>
              <button class="preset" onclick="loadPreset('viral','numa')">Numa Numa</button>
            </div>

            <div class="section-label">Saturation</div>
            <div class="form-grid">
              <div class="form-group full">
                <label>Title</label>
                <input type="text" id="v-title" placeholder="e.g., Charlie Bit My Finger">
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Year</label>
                <input type="number" id="v-year" placeholder="2007" min="1996">
                <span class="error-msg" id="v-year-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Views</label>
                <input type="number" id="v-views" placeholder="880000000" min="1">
                <span class="error-msg" id="v-views-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Platform Users</label>
                <input type="number" id="v-users" placeholder="200000000" min="1">
                <span class="error-msg" id="v-users-err">Required</span>
              </div>
              <div class="form-group">
                <label>Cross-Context Coefficient C (1-3.5)</label>
                <input type="number" id="v-c" value="1" min="1" max="3.5" step="0.1">
              </div>
            </div>

            <div class="section-label">Validation</div>
            <div class="form-grid">
              <div class="form-group">
                <label>Persistence (months)</label>
                <div class="slider-row">
                  <input type="range" id="v-p-slider" min="0" max="180" value="0">
                  <input type="number" id="v-p" min="0" max="180" value="0">
                </div>
              </div>
              <div class="form-group">
                <label>Resurfacing (0-10)</label>
                <input type="number" id="v-r" value="0" min="0" max="10" step="0.1">
              </div>
              <div class="form-group full">
                <label>Legacy</label>
                <select id="v-legacy">
                  <option value="1">None (1Ã—)</option>
                  <option value="1.5">Meme Format (1.5Ã—)</option>
                  <option value="2">Cultural Lexicon (2Ã—)</option>
                  <option value="2.5">Academic Study (2.5Ã—)</option>
                  <option value="3">Historical Artifact (3Ã—)</option>
                </select>
              </div>
            </div>

            <button class="btn btn-primary" onclick="calculate('viral')">Calculate TVI</button>
          </div>
        </div>
      </div>

      <!-- Datasets Form -->
      <div class="form-section" id="form-datasets" style="display:none">
        <div class="card">
          <div class="card-header">
            <h2>AI Dataset</h2>
            <button class="btn-ghost" onclick="resetForm('datasets')">Reset</button>
          </div>
          <div class="card-body">
            <div class="presets">
              <button class="preset" onclick="loadPreset('datasets','mnist')">MNIST</button>
              <button class="preset" onclick="loadPreset('datasets','imagenet')">ImageNet</button>
              <button class="preset" onclick="loadPreset('datasets','cifar')">CIFAR-10</button>
            </div>

            <div class="section-label">Saturation</div>
            <div class="form-grid">
              <div class="form-group full">
                <label>Name</label>
                <input type="text" id="d-name" placeholder="e.g., MNIST">
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Year</label>
                <input type="number" id="d-year" placeholder="1998" min="1980">
                <span class="error-msg" id="d-year-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Usage</label>
                <input type="number" id="d-usage" placeholder="50000000" min="1">
                <span class="error-msg" id="d-usage-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Researchers</label>
                <input type="number" id="d-researchers" placeholder="10000" min="1">
                <span class="error-msg" id="d-researchers-err">Required</span>
              </div>
              <div class="form-group">
                <label>Cross-Context Coefficient C (1-3.5)</label>
                <input type="number" id="d-c" value="1" min="1" max="3.5" step="0.1">
              </div>
            </div>

            <div class="section-label">Validation</div>
            <div class="form-grid">
              <div class="form-group">
                <label>Persistence (months)</label>
                <div class="slider-row">
                  <input type="range" id="d-p-slider" min="0" max="180" value="0">
                  <input type="number" id="d-p" min="0" max="180" value="0">
                </div>
              </div>
              <div class="form-group">
                <label>Resurfacing (0-10)</label>
                <input type="number" id="d-r" value="0" min="0" max="10" step="0.1">
              </div>
              <div class="form-group full">
                <label>Legacy</label>
                <select id="d-legacy">
                  <option value="1">Usable (1Ã—)</option>
                  <option value="1.5">Benchmark (1.5Ã—)</option>
                  <option value="2">Framework Default (2Ã—)</option>
                  <option value="2.5">Pedagogical (2.5Ã—)</option>
                  <option value="3">Historical (3Ã—)</option>
                </select>
              </div>
            </div>

            <button class="btn btn-primary" onclick="calculate('datasets')">Calculate TDIS</button>
          </div>
        </div>
      </div>

      <!-- Business Form -->
      <div class="form-section" id="form-business" style="display:none">
        <div class="card">
          <div class="card-header">
            <h2>Business Method</h2>
            <button class="btn-ghost" onclick="resetForm('business')">Reset</button>
          </div>
          <div class="card-body">
            <div class="presets">
              <button class="preset" onclick="loadPreset('business','smart')">SMART Goals</button>
              <button class="preset" onclick="loadPreset('business','okr')">OKRs</button>
              <button class="preset" onclick="loadPreset('business','agile')">Agile</button>
            </div>

            <div class="section-label">Saturation</div>
            <div class="form-grid">
              <div class="form-group full">
                <label>Name</label>
                <input type="text" id="b-name" placeholder="e.g., SMART Goals">
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Year</label>
                <input type="number" id="b-year" placeholder="1981" min="1950">
                <span class="error-msg" id="b-year-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Adoption</label>
                <input type="number" id="b-adoption" placeholder="100000000" min="1">
                <span class="error-msg" id="b-adoption-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Market Size</label>
                <input type="number" id="b-market" placeholder="50000000" min="1">
                <span class="error-msg" id="b-market-err">Required</span>
              </div>
              <div class="form-group">
                <label>Cross-Context Coefficient C (1-3)</label>
                <input type="number" id="b-c" value="1" min="1" max="3" step="0.1">
              </div>
            </div>

            <div class="section-label">Validation</div>
            <div class="form-grid">
              <div class="form-group">
                <label>Persistence (months)</label>
                <div class="slider-row">
                  <input type="range" id="b-p-slider" min="0" max="180" value="0">
                  <input type="number" id="b-p" min="0" max="180" value="0">
                </div>
              </div>
              <div class="form-group">
                <label>Resurfacing (0-10)</label>
                <input type="number" id="b-r" value="0" min="0" max="10" step="0.1">
              </div>
              <div class="form-group full">
                <label>Legacy</label>
                <select id="b-legacy">
                  <option value="1">Known (1Ã—)</option>
                  <option value="1.5">Common (1.5Ã—)</option>
                  <option value="2">Industry Standard (2Ã—)</option>
                  <option value="2.5">MBA Curriculum (2.5Ã—)</option>
                  <option value="3">Management Canon (3Ã—)</option>
                </select>
              </div>
            </div>

            <button class="btn btn-primary" onclick="calculate('business')">Calculate TVI-B</button>
          </div>
        </div>
      </div>

      <!-- Investment Form -->
      <div class="form-section" id="form-invest" style="display:none">
        <div class="card">
          <div class="card-header">
            <h2>Investment</h2>
            <button class="btn-ghost" onclick="resetForm('invest')">Reset</button>
          </div>
          <div class="card-body">
            <div class="presets">
              <button class="preset" onclick="loadPreset('invest','apple')">Apple</button>
              <button class="preset" onclick="loadPreset('invest','amazon')">Amazon</button>
              <button class="preset" onclick="loadPreset('invest','berkshire')">Berkshire</button>
            </div>

            <div class="section-label">Saturation</div>
            <div class="form-grid">
              <div class="form-group">
                <label>Company</label>
                <input type="text" id="i-name" placeholder="e.g., Apple">
              </div>
              <div class="form-group">
                <label>Ticker</label>
                <input type="text" id="i-ticker" placeholder="AAPL" style="text-transform:uppercase">
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Founded</label>
                <input type="number" id="i-year" placeholder="1976" min="1800">
                <span class="error-msg" id="i-year-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Brand (0-1)</label>
                <input type="number" id="i-brand" placeholder="0.95" min="0" max="1" step="0.01">
                <span class="error-msg" id="i-brand-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Position (1-10)</label>
                <input type="number" id="i-position" placeholder="10" min="1" max="10">
                <span class="error-msg" id="i-position-err">Required</span>
              </div>
              <div class="form-group">
                <label>Era (0.1-10)</label>
                <input type="number" id="i-era" value="1" min="0.1" max="10" step="0.1">
              </div>
            </div>

            <div class="section-label">Validation</div>
            <div class="form-grid">
              <div class="form-group">
                <label><span class="req">*</span> Sustained (months)</label>
                <div class="slider-row">
                  <input type="range" id="i-sus-slider" min="0" max="180" value="0">
                  <input type="number" id="i-sus" min="0" max="180" value="0">
                </div>
                <span class="error-msg" id="i-sus-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Crisis (0.1-3.5)</label>
                <input type="number" id="i-crisis" placeholder="3.0" min="0.1" max="3.5" step="0.1">
                <span class="error-msg" id="i-crisis-err">Required</span>
              </div>
              <div class="form-group">
                <label><span class="req">*</span> Leadership (0.5-3.5)</label>
                <input type="number" id="i-leadership" placeholder="3.5" min="0.5" max="3.5" step="0.1">
                <span class="error-msg" id="i-leadership-err">Required</span>
              </div>
            </div>

            <button class="btn btn-primary" onclick="calculate('invest')">Calculate ISPS</button>
          </div>
        </div>
      </div>

      <!-- Results -->
      <div class="results" id="results">
        <div class="card">
          <div class="result-score">
            <div class="label" id="r-type">TVI</div>
            <div class="value" id="r-score">0</div>
            <div class="name" id="r-name">-</div>
            <div class="year" id="r-year">-</div>
            <div class="result-badge" id="r-class">-</div>
          </div>
          <div class="result-components" id="r-components"></div>
          <div class="result-actions">
            <button class="btn btn-primary" onclick="downloadPDF()" id="pdf-btn">ðŸ“„ Download PDF Report</button>
            <button class="btn btn-secondary" onclick="copyResult()">ðŸ“‹ Copy</button>
            <button class="btn btn-secondary" onclick="downloadJSON()">â¬‡ JSON</button>
            <button class="btn btn-secondary" onclick="shareResult()">ðŸ”— Share</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section class="section page-section" id="sec-about">
      <div class="card">
        <div class="info-content">
          <h3>What TVI Is</h3>
          <p>TVI (Temporal Validation Index) is how you tell whether something will still matter after hype, cycles, and platform churn have burned away.</p>

          <div style="background:rgba(44,224,255,0.08);border:1px solid var(--accent);border-radius:var(--radius-sm);padding:16px;margin:20px 0;">
            <p style="margin:0;font-size:13px;line-height:1.6;color:var(--text-2);">
              <strong style="color:var(--accent);">TVI is a proprietary analytical framework</strong> developed by BoonMind Analytics. Patent applications are in preparation. The public calculator and demonstrations are provided for educational and evaluation purposes only. Commercial use, licensing, and API access require separate agreements.
            </p>
          </div>

          <div class="highlight-box">
            <p><strong>Problem:</strong> Modern metrics are inflated by platform size, algorithms, hype cycles, and short-term engagement. They miss longevity, reuse, cross-domain adoption, and historical embedding.</p>
          </div>

          <img src="assets/visuals/tvi-diagrams/tvi-structural-survival-vs-attention.png" alt="Graph comparing short-term attention spikes with long-term structural durability, showing attention peaking and collapsing while validated structure persists over time." class="tvi-diagram">
          <p class="framework-visual-caption">This chart contrasts short-term attention with long-term structural survival. Attention produces sharp but temporary spikes, while structurally validated signals persist after attention decays. TVI measures what remains once visibility fades.</p>

          <p>TVI exists to answer one question: <strong>Is this real â€” or just temporarily loud?</strong></p>

          <h3 style="margin-top:18px">What TVI Measures</h3>
          <ul>
            <li><strong>Contextual Saturation (CSI):</strong> How fully something occupied the attention space of its era (relative to what was possible). A-Factor (audience turnover) and C (cross-context escape) live here.</li>
            <li><strong>Temporal Validation (TVS):</strong> Persistence Ã— Resurfacing Ã— Legacy. Time is the hardest critic; TVS measures its verdict.</li>
            <li><strong>Structural Resistance (SRC):</strong> How hard it was to spread when it happened. Pre-algorithm eras were hostile; post-algorithm eras are jet fuel.</li>
          </ul>

          <div class="formula">TVI = CSI Ã— logâ‚â‚€(TVS + 1) Ã— SRC</div>

          <img src="assets/visuals/tvi-diagrams/tvi-methodology-framework.png" alt="Diagram showing the TVI methodology: CSI, TVS, and SRC feed into TVI = CSI Ã— log10(TVS + 1) Ã— SRC, producing the Temporal Validation Index over a short-term to long-term timeline." class="tvi-diagram">
          <p class="framework-visual-caption">The Survival Equation: How Saturation, Temporal Validation, and Structural Resistance create a "Volume of Persistence."</p>

          <p>This structure forces hype without time to collapse, scale without validation to decay, and proven survival to compound.</p>

          <h3 style="margin-top:18px">Why This Matters</h3>
          <p>TVI is a risk-reduction engine for high-stakes decisions in brand impact, long-term value measurement, cultural measurement, media valuation, and effectiveness over time:</p>
          <ul>
            <li><strong>AI & Data:</strong> Filter datasets/benchmarks by time-robustness, not popularity.</li>
            <li><strong>Governance & Policy:</strong> Separate real standards from policy theater.</li>
            <li><strong>Business & Strategy:</strong> See which methods became infrastructure vs fads.</li>
            <li><strong>Finance & Investment:</strong> Identify foundations, not trades â€” survival, crisis-resistance, dominance persistence.</li>
            <li><strong>Brand & Marketing Analytics:</strong> Measure long-term cultural impact and media valuation beyond short-term engagement metrics.</li>
          </ul>

          <p><strong>Output:</strong> One number that answers "If we bet on this, will time be on our side?"â€”grounded in the only signal no one can fake: time.</p>

          <h3 style="margin-top:32px">What TVI Would Have Changed â€” In Numbers</h3>
          
          <div style="text-align:center;margin:32px 0;">
            <div style="font-size:13px;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-3);margin-bottom:12px;">Capital Preserved (SoftBank / WeWork â€” Real Case)</div>
            <div style="font-size:72px;font-weight:800;font-family:'Inter Tight';line-height:1;color:var(--accent);text-shadow:0 0 40px rgba(44,224,255,0.3);">$8â€“10B</div>
            <div style="font-size:15px;color:var(--text-2);margin-top:12px;">Conservative estimate if TVI flagged structural fragility in 2017</div>
            <div style="font-size:12px;color:var(--text-3);margin-top:8px;font-style:italic;">Based on documented SoftBank Vision Fund exposure and write-downs</div>
          </div>
          
          <h4 style="margin-top:24px;color:var(--accent);">The Breakdown</h4>
          
          <div style="background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:24px;margin:20px 0;">
            <h5 style="margin-bottom:16px;font-size:14px;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-2);">What Actually Happened (Documented, Public Record)</h5>
            <ul style="margin:0;padding-left:20px;color:var(--text-2);font-size:14px;line-height:1.8;">
              <li>SoftBank total exposure: <strong style="color:var(--text);">~$16B</strong> (2017â€“2019)</li>
              <li>Peak valuation: <strong style="color:var(--text);">$47B</strong> (Aug 2019)</li>
              <li>Valuation after failed IPO: <strong style="color:var(--critical);">&lt;$10B</strong> (Q4 2019)</li>
            </ul>
            <p style="margin-top:12px;font-size:11px;color:var(--text-3);font-style:italic;">Sources: SoftBank Vision Fund quarterly reports (2019â€“2020), WSJ, FT</p>
          </div>

          <div style="background:rgba(255,45,85,0.1);border:1px solid var(--critical);border-radius:var(--radius-sm);padding:24px;margin:20px 0;">
            <h5 style="margin-bottom:16px;font-size:14px;text-transform:uppercase;letter-spacing:0.05em;color:var(--critical);">The Damage (Actual Write-Downs)</h5>
            <ul style="margin:0;padding-left:20px;color:var(--text-2);font-size:15px;line-height:1.8;">
              <li><strong style="color:var(--critical);font-size:18px;">$14â€“15B</strong> written down (FY 2019â€“2020)</li>
              <li><strong style="color:var(--critical);">~75%</strong> value destruction</li>
              <li>Peak to collapse: <strong style="color:var(--critical);">18 months</strong> (Jan 2018 â†’ Aug 2019)</li>
            </ul>
            <p style="margin-top:12px;font-size:11px;color:var(--text-3);font-style:italic;">Math: $16B exposure - ~$2B recovered = ~$14B loss</p>
          </div>

          <div style="background:rgba(44,224,255,0.1);border:1px solid var(--accent);border-radius:var(--radius-sm);padding:24px;margin:20px 0;">
            <h5 style="margin-bottom:16px;font-size:14px;text-transform:uppercase;letter-spacing:0.05em;color:var(--accent);">With TVI (Conservative Counterfactual)</h5>
            <p style="margin-bottom:12px;font-size:13px;color:var(--text-2);">Assuming TVI flags structural fragility in 2017 and limits exposure:</p>
            <ul style="margin:0;padding-left:20px;color:var(--text-2);font-size:15px;line-height:1.8;">
              <li>Initial exposure capped: <strong style="color:var(--accent);">$5â€“6B</strong> (not $16B)</li>
              <li>Capital not deployed: <strong style="color:var(--accent);">$10â€“11B</strong> (deferred pending multi-cycle validation)</li>
              <li>Loss at same 75% rate: <strong style="color:var(--accent);">~$4â€“5B</strong> (vs. $14B)</li>
              <li><strong style="color:var(--accent);font-size:18px;">Net capital preserved: $8â€“10B</strong> âœ“</li>
            </ul>
            <p style="margin-top:16px;font-size:12px;color:var(--text-3);font-style:italic;">Math: $14B actual loss - $4â€“5B hypothetical loss = $8â€“10B preserved</p>
            <p style="margin-top:8px;font-size:13px;color:var(--accent);font-weight:600;">This is downside protection, not return enhancement.</p>
          </div>

          <h4 style="margin-top:32px;color:var(--accent);">Risk Pricing Delta</h4>
          
          <p style="margin-top:12px;"><strong>Risk Mispricing Under ROI:</strong></p>
          <p style="color:var(--text-2);">ROI priced WeWork as a durable growth asset.</p>
          
          <p style="margin-top:16px;"><strong>TVI Repricing Effect:</strong></p>
          <p style="color:var(--text-2);">TVI would have applied:</p>
          <ul style="margin:12px 0 12px 24px;color:var(--text-2);">
            <li>Higher discount rates</li>
            <li>Lower terminal value assumptions</li>
            <li>Capped exposure until multi-cycle validation</li>
          </ul>

          <div style="background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:20px;margin:20px 0;">
            <p style="margin:0;font-size:14px;line-height:1.6;">
              <strong>ROI-implied expected return:</strong> +5â€“6Ã—<br>
              <strong>TVI-adjusted expected return:</strong> +1.5â€“2Ã—<br>
              <span style="color:var(--accent);">But with ~70% lower probability of catastrophic loss</span>
            </p>
          </div>

          <h4 style="margin-top:32px;color:var(--accent);">What TVI Protects</h4>
          
          <table style="width:100%;border-collapse:collapse;margin:20px 0;font-size:13px;">
            <thead>
              <tr style="background:var(--surface-2);border-bottom:2px solid var(--border);">
                <th style="padding:12px;text-align:left;font-weight:700;color:var(--text);">Risk Type</th>
                <th style="padding:12px;text-align:left;font-weight:700;color:var(--text);">ROI Visibility</th>
                <th style="padding:12px;text-align:left;font-weight:700;color:var(--text);">TVI Impact</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-bottom:1px solid var(--border-subtle);">
                <td style="padding:12px;color:var(--text-2);">Capital Overexposure</td>
                <td style="padding:12px;color:var(--text-3);">None</td>
                <td style="padding:12px;color:var(--accent);">Exposure capped</td>
              </tr>
              <tr style="border-bottom:1px solid var(--border-subtle);">
                <td style="padding:12px;color:var(--text-2);">Era Dependence</td>
                <td style="padding:12px;color:var(--text-3);">Ignored</td>
                <td style="padding:12px;color:var(--accent);">Discounted</td>
              </tr>
              <tr style="border-bottom:1px solid var(--border-subtle);">
                <td style="padding:12px;color:var(--text-2);">Structural Fragility</td>
                <td style="padding:12px;color:var(--text-3);">Invisible</td>
                <td style="padding:12px;color:var(--accent);">Penalised</td>
              </tr>
              <tr style="border-bottom:1px solid var(--border-subtle);">
                <td style="padding:12px;color:var(--text-2);">Downturn Sensitivity</td>
                <td style="padding:12px;color:var(--text-3);">Reactive</td>
                <td style="padding:12px;color:var(--accent);">Pre-priced</td>
              </tr>
              <tr>
                <td style="padding:12px;color:var(--text-2);">Loss Severity</td>
                <td style="padding:12px;color:var(--text-3);">Unbounded</td>
                <td style="padding:12px;color:var(--accent);">Bounded</td>
              </tr>
            </tbody>
          </table>

          <div style="background:linear-gradient(135deg,rgba(44,224,255,0.15),rgba(44,224,255,0.05));border:2px solid var(--accent);border-radius:var(--radius);padding:32px;margin:32px 0;text-align:center;">
            <div style="font-size:48px;font-weight:800;font-family:'Inter Tight';color:var(--accent);margin-bottom:16px;">50â€“70%</div>
            <p style="margin:0;font-size:16px;line-height:1.6;color:var(--text);">
              Downside reduction target for structurally fragile investments.<br>
              <strong style="color:var(--accent);">In large-scale allocation, that's billions preserved per fund.</strong>
            </p>
          </div>

          <p style="margin-top:24px;font-size:18px;font-weight:700;color:var(--text);text-align:center;padding:24px;background:var(--surface-2);border-radius:var(--radius-sm);border:1px solid var(--border);">
            ROI helps you maximise upside.<br>
            <span style="color:var(--accent);font-size:20px;">TVI helps you avoid $10B mistakes.</span>
          </p>

          <h3 style="margin-top:48px;padding-top:32px;border-top:1px solid var(--border);">Commercial Use & Licensing</h3>
          
          <p style="margin-top:16px;">TVI operates across three access layers:</p>
          
          <div style="background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:24px;margin:20px 0;">
            <h4 style="margin-bottom:12px;color:var(--accent);font-size:15px;">1. Public / Demonstrative</h4>
            <p style="margin:0;font-size:13px;line-height:1.6;color:var(--text-2);">
              The calculator and sample outputs on this site are provided for educational and evaluation purposes. They demonstrate TVI's approach to temporal validation, pattern recognition, and long-horizon comparison. <strong style="color:var(--text);">These outputs do not grant commercial usage rights.</strong>
            </p>
          </div>

          <div style="background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:24px;margin:20px 0;">
            <h4 style="margin-bottom:12px;color:var(--accent);font-size:15px;">2. Evaluation / Registered Access</h4>
            <p style="margin:0;font-size:13px;line-height:1.6;color:var(--text-2);">
              For organizations evaluating TVI for internal use, brand impact measurement, media valuation, or cultural analytics, registered evaluation access provides expanded capabilities and documentation. This includes deeper pattern analysis, historical comparisons, and framework documentation.
            </p>
          </div>

          <div style="background:rgba(44,224,255,0.1);border:1px solid var(--accent);border-radius:var(--radius-sm);padding:24px;margin:20px 0;">
            <h4 style="margin-bottom:12px;color:var(--accent);font-size:15px;">3. Commercial / Licensed Use</h4>
            <p style="margin:0;font-size:13px;line-height:1.6;color:var(--text-2);">
              Commercial licensing is required for: operational decision-making, investment analysis, client deliverables, API integration, white-label deployment, or any use where TVI scores inform business outcomes. Licensed access includes full formula access, custom domain configurations, API endpoints, and commercial usage rights.
            </p>
          </div>

          <h4 style="margin-top:32px;color:var(--accent);">When Is a License Required?</h4>
          <p style="margin-top:12px;color:var(--text-2);font-size:14px;">A TVI license is required when:</p>
          <ul style="margin:12px 0 12px 24px;color:var(--text-2);font-size:14px;line-height:1.8;">
            <li>TVI scores inform investment decisions, capital allocation, or portfolio management</li>
            <li>TVI analysis is included in client reports, deliverables, or advisory services</li>
            <li>TVI is integrated into internal analytics, dashboards, or decision-support systems</li>
            <li>TVI methodology is used for brand impact measurement, media valuation, or marketing analytics</li>
            <li>API access is needed for programmatic TVI calculation or bulk analysis</li>
            <li>White-label deployment is required for partner or client-facing applications</li>
          </ul>

          <h4 style="margin-top:32px;color:var(--accent);">Who Is TVI For?</h4>
          <p style="margin-top:12px;color:var(--text-2);font-size:14px;">TVI is designed for:</p>
          <ul style="margin:12px 0 12px 24px;color:var(--text-2);font-size:14px;line-height:1.8;">
            <li><strong>Investment firms and asset managers</strong> seeking downside protection and structural validation</li>
            <li><strong>Brand and marketing analytics teams</strong> measuring long-term cultural impact and media effectiveness</li>
            <li><strong>Media companies and content platforms</strong> evaluating long-term value and cultural measurement</li>
            <li><strong>AI and data organizations</strong> assessing dataset durability and benchmark staying power</li>
            <li><strong>Business strategy teams</strong> distinguishing infrastructure from fads in methodology adoption</li>
            <li><strong>Research institutions and consultancies</strong> requiring validated temporal frameworks</li>
          </ul>

          <div style="background:linear-gradient(135deg,rgba(44,224,255,0.15),rgba(44,224,255,0.05));border:2px solid var(--accent);border-radius:var(--radius);padding:32px;margin:32px 0;text-align:center;">
            <h4 style="margin-bottom:16px;color:var(--accent);font-size:18px;">Next Steps</h4>
            <p style="margin:0;font-size:14px;line-height:1.8;color:var(--text);">
              <strong>Contact</strong> â†’ Discuss your use case and evaluation needs<br>
              <strong>Evaluation</strong> â†’ Access expanded capabilities and documentation<br>
              <strong>Licensing</strong> â†’ Secure commercial usage rights and API access<br>
              <strong>Deployment</strong> â†’ Integrate TVI into your analytics, advisory, or operational workflows
            </p>
            <p style="margin-top:16px;font-size:12px;color:var(--text-3);font-style:italic;">Evaluation materials available on request.</p>
            <button class="btn btn-primary" onclick="document.getElementById('sec-contact').scrollIntoView({behavior:'smooth'})" style="margin-top:20px;">Start the Conversation</button>
          </div>
        </div>
      </div>
    </section>

    <!-- FRAMEWORK CONCEPTS -->
    <section class="section page-section" id="sec-framework">
      <div class="card">
        <div class="info-content">
          <h3>Framework Concepts</h3>
          <p>Deep visualizations of the TVI framework's core principles and applications.</p>

          <h3 style="margin-top:24px">The Dark Forest Filter</h3>
          <p>Early signals enter a "dark forest" of temporal validation. Time and stress remove weak, non-structural signals. Only those with genuine durability survive the filter.</p>
          <img src="assets/visuals/tvi-diagrams/tvi-dark-forest-temporal-filter.png" alt="Diagram showing early noisy signals passing through a temporal dark forest filter where time and stress remove weak signals, leaving only durable validated survivors." class="tvi-diagram">
          <p class="framework-visual-caption">This diagram illustrates how early high-noise, low-consensus signals are filtered over time. The &quot;Dark Forest Filter&quot; represents temporal validation, where stress and duration eliminate non-structural signals, leaving only those that remain durable under real-world conditions.</p>

          <h3 style="margin-top:32px">Structural Viability After Stress</h3>
          <p>When a shock event occurs, systems with low structural resistance enter irreversible decline. High-resistance systems decline slowly and retain recovery potential. Time acts as a stress multiplierâ€”the longer you survive under pressure, the more durable you prove to be.</p>
          <img src="assets/visuals/tvi-diagrams/tvi-structural-viability-over-time.png" alt="Line chart illustrating structural viability over time after a shock event; high structural resistance declines slowly and retains recovery potential while low resistance collapses irreversibly." class="tvi-diagram">
          <p class="framework-visual-caption">Decay dynamics: Structural resistance determines whether you recover from crisis or collapse into it.</p>

          <h3 style="margin-top:32px">The Breakthrough (Crisis-Proof Infrastructure)</h3>
          <p>Once an entity achieves a certain TVI density, it becomes "Invulnerable." It is no longer a guest in the market; it is part of the infrastructure.</p>
          <img src="assets/visuals/tvi-diagrams/tvi-temporal-stress-test-matrix.png" alt="Four-quadrant matrix showing how time and stress distinguish unvalidated noise, fragile growth, stress without persistence, and structurally validated signals." class="tvi-diagram">
          <p class="framework-visual-caption">This matrix visualizes how signals behave under combinations of time and stress. Only signals exposed to both long-term duration and real stress achieve structural validation. TVI measures survival across both dimensions.</p>

          <h3 style="margin-top:32px">Attention vs. Temporal Persistence</h3>
          <p>Most signals cluster in high-attention, low-persistence spaceâ€”viral noise that burns bright and vanishes. A small subset achieves the opposite: lower initial attention, but high long-term persistence. TVI measures what remains after visibility fades.</p>
          <img src="assets/visuals/tvi-diagrams/tvi-diagram-attention-vs-temporal-persistence.png" alt="Scatter plot comparing short-term attention volume with long-term temporal persistence; a dense cluster of viral noise contrasts with a smaller cluster of persistent signals, showing attention decays faster than structure." class="tvi-diagram">
          <p class="framework-visual-caption">The dissonance: Virality is a 24-hour phenomenon. Cultural legacy is built on density, not volume.</p>
        </div>
      </div>
    </section>

    <!-- COMPARE -->
    <section class="section page-section" id="sec-compare">
      <div class="card">
        <div class="card-body">
          <h3 style="text-align:center;margin-bottom:16px">Quick Compare</h3>
          <p style="text-align:center;color:var(--text-2);font-size:13px;margin-bottom:24px">Select two items and see which has more staying power.</p>
          
          <div class="compare-grid" id="compare-a">
            <div class="compare-item" data-item="charlie" onclick="selectCompare('a',this)">
              <img src="assets/icons/icon-charlie-bit-my-finger.svg" alt="Charlie Bit My Finger icon" class="compare-icon">
              <div class="name">Charlie Bit My Finger</div>
              <div class="meta">2007</div>
            </div>
            <div class="compare-item" data-item="gangnam" onclick="selectCompare('a',this)">
              <img src="assets/icons/icon-gangnam-style.svg" alt="Gangnam Style icon" class="compare-icon">
              <div class="name">Gangnam Style</div>
              <div class="meta">2012</div>
            </div>
            <div class="compare-item" data-item="mnist" onclick="selectCompare('a',this)">
              <img src="assets/icons/icon-mnist.svg" alt="MNIST icon" class="compare-icon">
              <div class="name">MNIST</div>
              <div class="meta">1998</div>
            </div>
            <div class="compare-item" data-item="apple" onclick="selectCompare('a',this)">
              <img src="assets/icons/icon-apple.svg" alt="Apple icon" class="compare-icon">
              <div class="name">Apple</div>
              <div class="meta">1976</div>
            </div>
          </div>

          <div class="compare-vs">VS</div>

          <div class="compare-grid" id="compare-b">
            <div class="compare-item" data-item="tiktok" onclick="selectCompare('b',this)">
              <img src="assets/icons/icon-tiktok.svg" alt="TikTok icon" class="compare-icon">
              <div class="name">TikTok 2024</div>
              <div class="meta">500M views</div>
            </div>
            <div class="compare-item" data-item="llama" onclick="selectCompare('b',this)">
              <img src="assets/icons/icon-llama.svg" alt="LLaMA icon" class="compare-icon">
              <div class="name">LLaMA</div>
              <div class="meta">2023</div>
            </div>
            <div class="compare-item" data-item="agile" onclick="selectCompare('b',this)">
              <img src="assets/icons/icon-agile.svg" alt="Agile icon" class="compare-icon">
              <div class="name">Agile</div>
              <div class="meta">2001</div>
            </div>
            <div class="compare-item" data-item="nvidia" onclick="selectCompare('b',this)">
              <img src="assets/icons/icon-nvidia.svg" alt="NVIDIA icon" class="compare-icon">
              <div class="name">NVIDIA</div>
              <div class="meta">1993</div>
            </div>
          </div>

          <button class="btn btn-primary" onclick="runCompare()">Compare</button>

          <div class="compare-result" id="compare-result">
            <div class="winner" id="cmp-winner">-</div>
            <div class="scores">
              <div class="score-item"><div class="val" id="cmp-a-score">-</div><div class="lbl" id="cmp-a-name">A</div></div>
              <div class="score-item"><div class="val" id="cmp-b-score">-</div><div class="lbl" id="cmp-b-name">B</div></div>
            </div>
            <p class="insight" id="cmp-insight"></p>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section class="section page-section" id="sec-contact">
      <div class="card">
        <form class="contact-form" name="contact" method="POST" action="/thanks/" data-netlify="true" netlify-honeypot="bot-field">
          <input type="hidden" name="form-name" value="contact">
          <p style="display:none"><label>Don't fill: <input name="bot-field"></label></p>
          <h3>Get in Touch</h3>
          <p class="intro">Interested in evaluation access, commercial licensing, API integration, or enterprise deployment? Let's discuss how TVI can support your brand impact measurement, media valuation, cultural analytics, or investment analysis needs.</p>
          <div class="form-grid">
            <div class="form-group">
              <label><span class="req">*</span> Name</label>
              <input type="text" name="name" required placeholder="Your name">
            </div>
            <div class="form-group">
              <label><span class="req">*</span> Email</label>
              <input type="email" name="email" required placeholder="you@company.com">
            </div>
            <div class="form-group full">
              <label>Company</label>
              <input type="text" name="company" placeholder="Company name">
            </div>
            <div class="form-group full">
              <label><span class="req">*</span> Message</label>
              <textarea name="message" required placeholder="Tell us about your use case..."></textarea>
            </div>
          </div>
          <button type="submit" class="btn btn-primary">Send Message</button>
        </form>
      </div>
    </section>

    <footer>
      <div class="ver">v1.0.1</div>
      <p>Universal Impact Calculator â€¢ <a href="#">BoonMind</a></p>
      <p style="margin-top:12px;font-size:11px;">
        <a href="/research/index.html">Research</a> â€¢ 
        <a href="/insights/index.html">Insights</a> â€¢ 
        <a href="/lexicon.html">Lexicon</a> â€¢ 
        <a href="/book.html">Book</a> â€¢ 
        <a href="/terms.html">Terms</a> â€¢ 
        <a href="/privacy.html">Privacy</a> â€¢ 
        <a href="/dashboard.html">Dashboard</a>
      </p>
      <p style="margin-top:16px;font-size:12px;color:var(--text-3);font-style:italic;">
        Read the full framework in <a href="/book.html" style="color:var(--accent);">TIME AS PROOF</a> â€” The Mathematics of What Lasts
      </p>
      <p style="margin-top:20px;font-size:11px;color:var(--text-3);line-height:1.6;">
        <strong style="color:var(--text-2);">TVI is a proprietary analytical framework.</strong> Patent applications in preparation. Public calculator outputs are demonstrative and not licensed for commercial use. For evaluation access, commercial licensing, or API integration, <a href="#sec-contact" style="color:var(--accent);">contact us</a>.
      </p>
      
      <!-- Newsletter Signup (Netlify-friendly) -->
      <form name="newsletter" method="POST" action="/thanks/" data-netlify="true" netlify-honeypot="bot-field" style="margin-top:32px;max-width:500px;margin-left:auto;margin-right:auto;" onsubmit="return handleNewsletterSubmit(event)">
        <input type="hidden" name="form-name" value="newsletter">
        <p style="display:none"><label>Don't fill: <input name="bot-field"></label></p>
        <p style="font-size:13px;color:var(--text-2);margin-bottom:12px;">Get TVI insights, research updates, and staying power analysis:</p>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <input type="email" name="email" placeholder="your@email.com" required style="flex:1;min-width:200px;padding:10px 12px;background:var(--surface);border:1px solid var(--border-subtle);border-radius:var(--radius-sm);color:var(--text);font-family:inherit;font-size:14px;">
          <button type="submit" style="padding:10px 20px;background:var(--accent-dim);border:1px solid var(--accent);border-radius:var(--radius-sm);color:var(--accent);font-weight:700;font-size:13px;cursor:pointer;font-family:inherit;">Subscribe</button>
        </div>
        <p id="newsletter-success" style="display:none;margin-top:12px;font-size:12px;color:var(--accent);">âœ“ Subscribed! Check your email.</p>
      </form>
    </footer>
  </div>

  <div class="toast" id="toast"></div>

  <!-- Analytics (PostHog) - Replace with your project API key -->
  <script>
    !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
    posthog.init('YOUR-POSTHOG-API-KEY',{api_host:'https://app.posthog.com', loaded: function(posthog) {
      // Track page views
      posthog.capture('$pageview');
      // Set up event tracking
      window.trackEvent = (event, properties) => posthog.capture(event, properties);
    }})
  </script>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.3/dist/umd/supabase.min.js"></script>
  <script>
    const NOW = new Date().getFullYear();
    // Supabase config (replace with real project keys)
    const SUPABASE_URL = window.SUPABASE_URL || 'https://YOUR-SUPABASE-PROJECT.supabase.co';
    const SUPABASE_KEY = window.SUPABASE_KEY || 'YOUR-SUPABASE-ANON-KEY';
    const supabaseClient = (SUPABASE_URL && SUPABASE_KEY && window.supabase)
      ? window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY)
      : null;
    let currentDomain = 'viral';
    let lastResult = null;
    let compareSelections = { a: null, b: null };

    // Presets
    const presets = {
      viral: {
        charlie: { title: 'Charlie Bit My Finger', year: 2007, views: 880000000, users: 200000000, c: 3, p: 180, r: 0.5, legacy: 2.5 },
        gangnam: { title: 'Gangnam Style', year: 2012, views: 4900000000, users: 800000000, c: 3.5, p: 144, r: 0.6, legacy: 2 },
        numa: { title: 'Numa Numa', year: 2004, views: 100000000, users: 50000000, c: 2.5, p: 180, r: 0.4, legacy: 2 }
      },
      datasets: {
        mnist: { name: 'MNIST', year: 1998, usage: 50000000, researchers: 10000, c: 3.5, p: 180, r: 0.9, legacy: 3 },
        imagenet: { name: 'ImageNet', year: 2009, usage: 30000000, researchers: 50000, c: 3.5, p: 180, r: 0.95, legacy: 3 },
        cifar: { name: 'CIFAR-10', year: 2009, usage: 20000000, researchers: 50000, c: 3, p: 180, r: 0.8, legacy: 2.5 }
      },
      business: {
        smart: { name: 'SMART Goals', year: 1981, adoption: 100000000, market: 50000000, c: 3, p: 180, r: 0.8, legacy: 3 },
        okr: { name: 'OKRs', year: 1999, adoption: 50000000, market: 80000000, c: 2.5, p: 180, r: 0.7, legacy: 2.5 },
        agile: { name: 'Agile/Scrum', year: 2001, adoption: 80000000, market: 100000000, c: 2.5, p: 180, r: 0.9, legacy: 2.5 }
      },
      invest: {
        apple: { name: 'Apple', ticker: 'AAPL', year: 1976, brand: 0.95, position: 10, era: 0.5, sus: 180, crisis: 3, leadership: 3.5 },
        amazon: { name: 'Amazon', ticker: 'AMZN', year: 1994, brand: 0.92, position: 9, era: 1, sus: 180, crisis: 2.5, leadership: 3.5 },
        berkshire: { name: 'Berkshire Hathaway', ticker: 'BRK.A', year: 1965, brand: 0.70, position: 8, era: 0.5, sus: 180, crisis: 3.5, leadership: 2.5 }
      }
    };

    const compareData = {
      charlie: { domain: 'viral', ...presets.viral.charlie },
      gangnam: { domain: 'viral', ...presets.viral.gangnam },
      tiktok: { domain: 'viral', title: 'TikTok 2024', year: 2024, views: 500000000, users: 1500000000, c: 1.5, p: 3, r: 0.1, legacy: 1 },
      mnist: { domain: 'datasets', ...presets.datasets.mnist },
      llama: { domain: 'datasets', name: 'LLaMA', year: 2023, usage: 5000000, researchers: 500000, c: 2, p: 18, r: 0.3, legacy: 1 },
      agile: { domain: 'business', ...presets.business.agile },
      apple: { domain: 'invest', ...presets.invest.apple },
      nvidia: { domain: 'invest', name: 'NVIDIA', ticker: 'NVDA', year: 1993, brand: 0.85, position: 9, era: 1.5, sus: 180, crisis: 2.5, leadership: 3.5 }
    };

    // Utils
    function $(id) { return document.getElementById(id); }
    function num(id, fallback = 0) { const v = parseFloat($(id)?.value); return Number.isFinite(v) ? v : fallback; }
    function clamp(v, min, max) { return Math.min(Math.max(v, min), max); }
    function classify(score, domain) {
      if (domain === 'invest') {
        if (score < 5) return 'Ephemeral Hype';
        if (score < 20) return 'Trend Riding';
        if (score < 50) return 'Validated';
        return 'Foundation';
      }
      if (score < 1) return 'Ephemeral';
      if (score < 5) return 'Viral Moment';
      if (score < 15) return 'Cultural Event';
      if (score < 30) return 'Milestone';
      if (score < 50) return 'Foundation';
      return 'Phenomenon';
    }
    function toast(msg) {
      const t = $('toast');
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(() => t.classList.remove('show'), 2500);
    }

    // Domain switching
    function selectDomain(domainKey){
      const map = {
        ai: 'datasets', data: 'datasets', dataset: 'datasets', datasets: 'datasets',
        business: 'business', methods: 'business',
        invest: 'invest', investment: 'invest', investments: 'invest',
        culture: 'viral', media: 'viral', viral: 'viral'
      };
      const target = map[domainKey] || domainKey;
      const btn = document.querySelector(`.domain-btn[data-domain="${target}"]`);
      if(btn){
        btn.click();
        const calc = document.getElementById('sec-calc');
        if(calc) calc.scrollIntoView({behavior:'smooth'});
      }
    }

    document.querySelectorAll('.domain-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.domain-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentDomain = btn.dataset.domain;
        document.querySelectorAll('.form-section').forEach(f => f.style.display = 'none');
        $('form-' + currentDomain).style.display = 'block';
        $('results').classList.remove('show');
      });
    });

    // Slider sync
    function syncSlider(sliderId, numId) {
      const slider = $(sliderId), num = $(numId);
      if (!slider || !num) return;
      slider.oninput = () => num.value = slider.value;
      num.oninput = () => slider.value = clamp(parseFloat(num.value) || 0, 0, 180);
    }
    syncSlider('v-p-slider', 'v-p');
    syncSlider('d-p-slider', 'd-p');
    syncSlider('b-p-slider', 'b-p');
    syncSlider('i-sus-slider', 'i-sus');

    // Load preset
    function loadPreset(domain, key) {
      const d = presets[domain]?.[key];
      if (!d) return;
      if (domain === 'viral') {
        $('v-title').value = d.title || '';
        $('v-year').value = d.year;
        $('v-views').value = d.views;
        $('v-users').value = d.users;
        $('v-c').value = d.c;
        $('v-p').value = d.p;
        $('v-p-slider').value = d.p;
        $('v-r').value = d.r;
        $('v-legacy').value = d.legacy;
      } else if (domain === 'datasets') {
        $('d-name').value = d.name || '';
        $('d-year').value = d.year;
        $('d-usage').value = d.usage;
        $('d-researchers').value = d.researchers;
        $('d-c').value = d.c;
        $('d-p').value = d.p;
        $('d-p-slider').value = d.p;
        $('d-r').value = d.r;
        $('d-legacy').value = d.legacy;
      } else if (domain === 'business') {
        $('b-name').value = d.name || '';
        $('b-year').value = d.year;
        $('b-adoption').value = d.adoption;
        $('b-market').value = d.market;
        $('b-c').value = d.c;
        $('b-p').value = d.p;
        $('b-p-slider').value = d.p;
        $('b-r').value = d.r;
        $('b-legacy').value = d.legacy;
      } else if (domain === 'invest') {
        $('i-name').value = d.name || '';
        $('i-ticker').value = d.ticker || '';
        $('i-year').value = d.year;
        $('i-brand').value = d.brand;
        $('i-position').value = d.position;
        $('i-era').value = d.era;
        $('i-sus').value = d.sus;
        $('i-sus-slider').value = d.sus;
        $('i-crisis').value = d.crisis;
        $('i-leadership').value = d.leadership;
      }
      toast('âœ“ Loaded');
    }

    // Reset
    function resetForm(domain) {
      const form = $('form-' + domain);
      form.querySelectorAll('input[type="text"],input[type="number"]').forEach(i => i.value = i.defaultValue || '');
      form.querySelectorAll('input[type="range"]').forEach(i => i.value = 0);
      form.querySelectorAll('select').forEach(s => s.selectedIndex = 0);
      form.querySelectorAll('.error-msg').forEach(e => e.classList.remove('show'));
      form.querySelectorAll('input.error').forEach(i => i.classList.remove('error'));
      $('results').classList.remove('show');
    }

    // Validation helper
    function validate(id, min, max = Infinity) {
      const el = $(id);
      const v = parseFloat(el.value);
      const errEl = $(id + '-err');
      if (!Number.isFinite(v) || v < min || v > max) {
        el.classList.add('error');
        if (errEl) errEl.classList.add('show');
        return null;
      }
      el.classList.remove('error');
      if (errEl) errEl.classList.remove('show');
      return v;
    }

    // Calculation now handled by /api/tvi-run (server-side)

    async function calculate(domain) {
      // Show loading state
      toast('Calculating...');
      
      // Gather inputs based on domain
      let inputs = {};
      let name, year;

      if (domain === 'viral') {
        const y = validate('v-year', 1996, NOW);
        const views = validate('v-views', 1);
        const users = validate('v-users', 1);
        if (y === null || views === null || users === null) return;
        
        name = $('v-title').value || 'Untitled';
        year = y;
        
        inputs = {
          year: y,
          views,
          users,
          c: clamp(num('v-c', 1), 1, 3.5),
          p: clamp(num('v-p', 0), 0, 180),
          r: clamp(num('v-r', 0), 0, 10),
          legacy: parseFloat($('v-legacy').value),
          name
        };
      } else if (domain === 'datasets') {
        const y = validate('d-year', 1980, NOW);
        const usage = validate('d-usage', 1);
        const researchers = validate('d-researchers', 1);
        if (y === null || usage === null || researchers === null) return;
        
        name = $('d-name').value || 'Untitled';
        year = y;
        
        inputs = {
          year: y,
          usage,
          researchers,
          c: clamp(num('d-c', 1), 1, 3.5),
          p: clamp(num('d-p', 0), 0, 180),
          r: clamp(num('d-r', 0), 0, 10),
          legacy: parseFloat($('d-legacy').value),
          name
        };
      } else if (domain === 'business') {
        const y = validate('b-year', 1950, NOW);
        const adoption = validate('b-adoption', 1);
        const market = validate('b-market', 1);
        if (y === null || adoption === null || market === null) return;
        
        name = $('b-name').value || 'Untitled';
        year = y;
        
        inputs = {
          year: y,
          adoption,
          market,
          c: clamp(num('b-c', 1), 1, 3),
          p: clamp(num('b-p', 0), 0, 180),
          r: clamp(num('b-r', 0), 0, 10),
          legacy: parseFloat($('b-legacy').value),
          name
        };
      } else if (domain === 'invest') {
        const y = validate('i-year', 1800, NOW);
        const brand = validate('i-brand', 0, 1);
        const position = validate('i-position', 1, 10);
        const sus = validate('i-sus', 0, 180);
        const crisis = validate('i-crisis', 0.1, 3.5);
        const leadership = validate('i-leadership', 0.5, 3.5);
        if ([y, brand, position, sus, crisis, leadership].some(v => v === null)) return;
        
        const ticker = $('i-ticker').value;
        name = ticker ? `${$('i-name').value || 'Untitled'} (${ticker.toUpperCase()})` : ($('i-name').value || 'Untitled');
        year = y;
        
        // Use TVI Engine directly for real mathematical calculation
        if (window.TVIEngine) {
          const industry = $('i-industry')?.value || 'tech';
          const profitable = $('i-profitable')?.value || 'yes';
          const leaderDependency = $('i-leader')?.value || 'medium';
          
          const result = TVIEngine.calculateCompanyISPS({
            name: $('i-name').value || 'Untitled',
            foundedYear: y,
            industry: industry,
            brandAwareness: brand * 100, // Convert 0-1 to 0-100
            marketPosition: position,
            crisesSurvived: Math.round(crisis / 0.5), // Convert to 0-5 scale
            profitable: profitable,
            leaderDependency: leaderDependency
          });
          
          // Format result for display
          showFullResults({
            score: result.score,
            type: 'ISPS',
            classification: result.status,
            components: result.components,
            drivers: [
              result.diagnosis || 'TVI analysis complete.',
              `D-score: ${result.dScore} (${result.dScore > 1.85 ? 'critical' : result.dScore > 1.75 ? 'warning' : 'stable'})`,
              `10-year survival probability: ${result.survivalProb10}%`
            ]
          }, name, year, domain);
          
          if (window.trackEvent) {
            window.trackEvent('tvi_calculation_completed', { domain, score: result.score, authenticated: isLoggedIn() });
          }
          return;
        }
        
        // Fallback to API if engine not loaded
        inputs = {
          year: y,
          brand,
          position,
          era: Math.max(0.1, clamp(num('i-era', 1), 0.1, 10)),
          sus,
          crisis,
          leadership,
          name,
          ticker
        };
      }

      // Track calculation event
      if (window.trackEvent) {
        window.trackEvent('tvi_calculation_started', { domain, authenticated: isLoggedIn() });
      }
      
      // Call backend API (for other domains or fallback)
      await callTVIAPI(domain, inputs, name, year);
    }

    async function callTVIAPI(domain, inputs, name, year) {
      try {
        const authHeader = window.__supabaseSession ? 
          { 'Authorization': `Bearer ${window.__supabaseSession.access_token}` } : {};
        
        const response = await fetch('/api/tvi-run', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            ...authHeader
          },
          body: JSON.stringify({ domain, inputs })
        });

        const result = await response.json();
        
        if (!response.ok) {
          if (response.status === 429) {
            toast(result.message || 'Rate limit exceeded');
            if (result.upgrade_url) {
              setTimeout(() => {
                if(confirm('Upgrade to Pro for unlimited calculations?')) {
                  window.location.href = result.upgrade_url;
                }
              }, 1000);
            }
            return;
          }
          throw new Error(result.error || 'Calculation failed');
        }

        // Handle preview mode
        if (result.preview) {
          showPreviewResults(result, name, year, domain);
        } else {
          showFullResults(result, name, year, domain);
        }

      } catch (err) {
        console.error('API call failed:', err);
        toast('Calculation failed. Please try again.');
      }
    }

    function showPreviewResults(result, name, year, domain) {
      // Show limited preview
      lastResult = {
        preview: true,
        name,
        year,
        classification: result.classification,
        band: result.band,
        domain
      };
      
      $('r-type').textContent = getTypeName(domain);
      $('r-score').textContent = '???';
      $('r-score').style.filter = 'blur(8px)';
      $('r-name').textContent = name;
      $('r-year').textContent = year;
      $('r-class').textContent = result.classification;
      $('r-components').innerHTML = `
        <div style="grid-column:1/-1;padding:24px;text-align:center;background:var(--accent-dim);border-radius:var(--radius-sm);">
          <p style="font-size:14px;margin-bottom:12px;font-weight:600;">${result.interpretation}</p>
          <p style="font-size:13px;color:var(--text-2);margin-bottom:16px;">${result.message}</p>
          <button class="btn btn-primary" onclick="showLoginModal()">Create Free Account</button>
        </div>
      `;
      
      // Hide PDF/export buttons for preview
      $('pdf-btn').style.display = 'none';
      document.querySelectorAll('.result-actions .btn-secondary').forEach(b => b.style.display = 'none');
      
      $('results').classList.add('show');
      $('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function showFullResults(result, name, year, domain) {
      lastResult = {
        name,
        year,
        score: result.score,
        type: getTypeName(domain),
        domain,
        components: result.components,
        classification: result.classification,
        drivers: result.drivers,
        calcId: result.calculation_id
      };
      
      $('r-type').textContent = lastResult.type;
      $('r-score').textContent = result.score.toFixed(1);
      $('r-score').style.filter = 'none';
      $('r-name').textContent = name;
      $('r-year').textContent = year;
      $('r-class').textContent = result.classification;
      
      // Show components
      const compArray = Object.entries(result.components).map(([k, v]) => ({
        l: k,
        v: typeof v === 'number' ? v.toFixed(k === 'SRC' ? 1 : 2) : v
      }));
      $('r-components').innerHTML = compArray.map(c => 
        `<div class="component"><div class="val">${c.v}</div><div class="lbl">${c.l}</div></div>`
      ).join('');
      
      // Show all action buttons
      $('pdf-btn').style.display = 'block';
      document.querySelectorAll('.result-actions .btn-secondary').forEach(b => b.style.display = 'block');
      
      $('results').classList.add('show');
      $('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function getTypeName(domain) {
      const types = {
        'viral': 'TVI',
        'culture': 'TVI',
        'datasets': 'TDIS',
        'ai': 'TDIS',
        'business': 'TVI-B',
        'invest': 'ISPS'
      };
      return types[domain] || 'TVI';
    }

    // Remove old client-side calculation logic

    // Results actions
    function copyResult() {
      if (!lastResult) return;
      if (lastResult.preview) {
        toast('Create an account to access full results.');
        showLoginModal();
        return;
      }
      navigator.clipboard.writeText(`${lastResult.name} (${lastResult.year})\n${lastResult.type}: ${lastResult.score.toFixed(2)}\n${lastResult.classification}`).then(() => toast('âœ“ Copied'));
    }
    function downloadJSON() {
      if (!lastResult) return;
      if (lastResult.preview) {
        toast('Create an account to export full data.');
        showLoginModal();
        return;
      }
      const blob = new Blob([JSON.stringify(lastResult, null, 2)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `${lastResult.type}-${lastResult.name.replace(/[^a-z0-9]/gi, '-')}.json`;
      a.click();
      toast('âœ“ Downloaded');
    }
    function shareResult() {
      if (!lastResult) return;
      if (lastResult.preview) {
        toast('Create an account to share full results.');
        showLoginModal();
        return;
      }
      try {
        const data = btoa(unescape(encodeURIComponent(JSON.stringify({ n: lastResult.name, s: lastResult.score.toFixed(1), t: lastResult.type }))));
        navigator.clipboard.writeText(location.origin + location.pathname + '?r=' + data).then(() => toast('âœ“ Link copied'));
      } catch { toast('Could not copy'); }
    }
    async function downloadPDF() {
      if (!lastResult) return;
      
      if (!isLoggedIn()) {
        toast('Please sign in to download PDF reports.');
        showLoginModal();
        return;
      }

      if (lastResult.preview) {
        toast('Create an account to download full PDF reports.');
        showLoginModal();
        return;
      }

      // Generate signed token for PDF download
      if (lastResult.calcId) {
        try {
          const response = await fetch('/api/generate-pdf-token', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${window.__supabaseSession.access_token}`
            },
            body: JSON.stringify({ calculationId: lastResult.calcId })
          });

          const { token, download_url } = await response.json();
          
          if (token) {
            window.open(download_url, '_blank');
            toast('ðŸ“„ Generating secure PDF...');
          } else {
            toast('Failed to generate download link.');
          }
        } catch (err) {
          console.error('PDF token generation failed:', err);
          toast('PDF download failed. Please try again.');
        }
      } else {
        toast('Please re-run calculation to generate PDF.');
      }
    }

    // Compare
    function selectCompare(slot, el) {
      const container = document.getElementById('compare-' + slot);
      if (!container) return;
      container.querySelectorAll('.compare-item').forEach(i => i.classList.remove('selected'));
      el.classList.add('selected');
      compareSelections[slot] = el.dataset.item;
    }

    function runCompare() {
      if (!compareSelections.a || !compareSelections.b) { 
        toast('Please select one item from each column'); 
        return; 
      }
      const a = compareData[compareSelections.a];
      const b = compareData[compareSelections.b];
      if (!a || !b) {
        toast('Error: Could not find comparison data');
        return;
      }
      const scoreA = calcScore(a);
      const scoreB = calcScore(b);
      const aName = a.title || a.name;
      const bName = b.title || b.name;
      const resultEl = document.getElementById('compare-result');
      if (!resultEl) return;
      
      document.getElementById('cmp-a-name').textContent = aName;
      document.getElementById('cmp-b-name').textContent = bName;
      document.getElementById('cmp-a-score').textContent = scoreA.toFixed(1);
      document.getElementById('cmp-b-score').textContent = scoreB.toFixed(1);
      document.getElementById('cmp-winner').textContent = scoreA > scoreB ? `ðŸ† ${aName}` : `ðŸ† ${bName}`;
      document.getElementById('cmp-insight').textContent = scoreA > scoreB 
        ? `${aName}'s earlier era and temporal validation outweigh raw metrics.`
        : `${bName} edges ahead through its combination of saturation and validation.`;
      resultEl.classList.add('show');
    }

    function calcScore(d) {
      // Use TVI Engine for real mathematical calculations
      if (!window.TVIEngine) {
        console.error('TVIEngine not loaded');
        return 0;
      }
      
      if (d.domain === 'viral') {
        // Map to content TVI calculation
        const platform = d.platform || 'youtube';
        const persistenceMonths = d.p || 0;
        const resurfacing = d.r || 0;
        const legacy = d.legacy || 1;
        const crossContext = d.c || 1.5;
        
        const result = TVIEngine.calculateContentTVI({
          name: d.title || d.name || 'Untitled',
          year: d.year,
          platform: platform,
          views: d.views,
          platformUsers: d.users,
          persistenceMonths: persistenceMonths,
          resurfacing: resurfacing,
          legacy: legacy,
          crossContext: crossContext
        });
        return result.score;
      } else if (d.domain === 'invest') {
        // Map to company ISPS calculation
        const industry = d.industry || 'tech';
        const brandAwareness = (d.brand || 0) * 100; // Convert 0-1 to 0-100
        const marketPosition = d.position || 5;
        const crisesSurvived = Math.round((d.crisis || 0) / 0.5); // Convert to 0-5 scale
        const profitable = d.profitable || 'yes';
        const leaderDependency = d.leaderDependency || 'medium';
        
        const result = TVIEngine.calculateCompanyISPS({
          name: d.name || 'Untitled',
          foundedYear: d.year,
          industry: industry,
          brandAwareness: brandAwareness,
          marketPosition: marketPosition,
          crisesSurvived: crisesSurvived,
          profitable: profitable,
          leaderDependency: leaderDependency
        });
        return result.score;
      } else if (d.domain === 'business') {
        // For business methodologies, use simplified TVI calculation
        const SRC = TVIEngine.calculateSRC(d.year);
        const BSI = (d.adoption / 1.5) / d.market * d.c;
        const TVS = d.p * d.r * d.legacy;
        return BSI * Math.log10(TVS + 1) * SRC;
      } else if (d.domain === 'datasets') {
        // For datasets, use simplified TVI calculation
        const SRC = TVIEngine.calculateSRC(d.year);
        const DSI = (d.usage / 2) / d.researchers * d.c;
        const TVS = d.p * d.r * d.legacy;
        return DSI * Math.log10(TVS + 1) * SRC;
      }
      return 0;
    }

    // ================= LOCAL AUTH =================
    const AUTH_KEY = 'tvi_user'; // legacy fallback

    function showLoginModal() {
      document.getElementById('login-modal').style.display = 'flex';
    }
    function closeLoginModal() {
      document.getElementById('login-modal').style.display = 'none';
    }
    function isLoggedIn() {
      return !!window.__supabaseSession;
    }
    async function attemptLogin() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      if (!supabaseClient) {
        document.getElementById('login-error').style.display = 'block';
        return;
      }
      if (email && email.includes('@') && password.length > 0) {
        const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });
        if (error) {
          document.getElementById('login-error').style.display = 'block';
          return;
        }
        window.__supabaseSession = data.session;
        closeLoginModal();
        toast('âœ… Signed in as ' + email);
        updateUIForAuth();
        if (window.trackEvent) window.trackEvent('user_login', { email });
      } else {
        document.getElementById('login-error').style.display = 'block';
      }
    }
    async function signUpInstead() {
      if (!supabaseClient) {
        document.getElementById('login-error').style.display = 'block';
        return;
      }
      const email = document.getElementById('login-email').value || 'demo@example.com';
      const password = document.getElementById('login-password').value || crypto.randomUUID();
      const { data, error } = await supabaseClient.auth.signUp({ email, password });
      if (error) {
        document.getElementById('login-error').style.display = 'block';
        return;
      }
      window.__supabaseSession = data.session;
      closeLoginModal();
      toast('âœ… Account created. Welcome!');
      updateUIForAuth();
      if (window.trackEvent) window.trackEvent('user_signup', { email });
    }
    async function logout() {
      if (supabaseClient) await supabaseClient.auth.signOut();
      window.__supabaseSession = null;
      toast('Signed out.');
      updateUIForAuth();
    }
    function updateUIForAuth() {
      const user = window.__supabaseSession?.user || null;
      const authButtons = document.querySelectorAll('.auth-btn');
      authButtons.forEach(btn => {
        if (btn.classList.contains('login-btn')) {
          btn.style.display = user ? 'none' : 'inline-block';
        }
        if (btn.classList.contains('logout-btn')) {
          btn.style.display = user ? 'inline-block' : 'none';
          if (user) btn.textContent = `Logout (${user.email})`;
        }
      });
    }
    async function logDownload(reportName) {
      if (!supabaseClient || !window.__supabaseSession) return;
      try {
        await supabaseClient.from('downloads').insert({
          user_id: window.__supabaseSession.user.id,
          report_name: reportName,
          created_at: new Date().toISOString()
        });
      } catch(err){
        console.warn('logDownload failed', err);
      }
    }
    async function downloadSampleReport(reportName) {
      if (!isLoggedIn()) {
        toast('Please sign in to download sample reports.');
        showLoginModal();
        return;
      }
      
      // Show disclaimer modal before download
      showSampleDisclaimer(reportName);
    }
    
    function showSampleDisclaimer(reportName) {
      const modal = document.getElementById('sample-disclaimer-modal');
      modal.style.display = 'flex';
      
      // Set download action
      document.getElementById('proceed-download-btn').onclick = async () => {
        modal.style.display = 'none';
        await logDownload(reportName);
        const link = document.createElement('a');
        link.href = `reports/TVI PDF Download Reports/${reportName}.pdf`;
        link.download = `${reportName}.pdf`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        toast(`ðŸ“¥ Downloading ${reportName}...`);
      };
    }
    
    function closeSampleDisclaimer() {
      document.getElementById('sample-disclaimer-modal').style.display = 'none';
    }

    // domain preselect from URL (query, hash, or path)
    (function(){
      const params = new URLSearchParams(window.location.search);
      let domainKey = params.get('domain');
      if(!domainKey && window.location.hash){
        domainKey = window.location.hash.replace('#','');
      }
      if(!domainKey){
        const path = window.location.pathname || '';
        if(path.includes('tvi-ai')) domainKey = 'ai';
        else if(path.includes('tvi-business')) domainKey = 'business';
        else if(path.includes('tvi-invest')) domainKey = 'invest';
        else if(path.includes('tvi-culture')) domainKey = 'culture';
      }
      if(domainKey) selectDomain(domainKey);

      // Initialize auth UI via Supabase
      if (supabaseClient) {
        supabaseClient.auth.getSession().then(({ data }) => {
          window.__supabaseSession = data.session;
          updateUIForAuth();
          if (!data.session) {
            document.querySelectorAll('.login-btn').forEach(b => b.style.display = 'inline-block');
          }
        });
        supabaseClient.auth.onAuthStateChange((event, session) => {
          window.__supabaseSession = session;
          updateUIForAuth();
        });
      } else {
        updateUIForAuth();
        document.querySelectorAll('.login-btn').forEach(b => b.style.display = 'inline-block');
      }
    })();
    
    // Newsletter signup handler
    function handleNewsletterSubmit(e) {
      // Let Netlify handle it, but show success message
      setTimeout(() => {
        const successMsg = document.getElementById('newsletter-success');
        if (successMsg) successMsg.style.display = 'block';
      }, 100);
      return true; // Allow form to submit to Netlify
    }
  </script>

  <!-- Login Modal -->
  <div id="login-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:9999; align-items:center; justify-content:center;">
    <div style="background:var(--bg1); border:1px solid var(--border); border-radius:var(--radius); padding:32px; max-width:400px; width:90%;">
      <h3 style="margin-bottom:8px;">Sign in to download reports</h3>
      <p style="color:var(--text-2); font-size:14px; margin-bottom:20px;">Free account required. No credit card.</p>
      
      <div style="display:flex; flex-direction:column; gap:12px;">
        <input type="email" id="login-email" placeholder="Email" style="padding:12px; background:var(--surface); border:1px solid var(--border-subtle); border-radius:var(--radius-sm); color:var(--text); font-family:inherit;">
        <input type="password" id="login-password" placeholder="Password" style="padding:12px; background:var(--surface); border:1px solid var(--border-subtle); border-radius:var(--radius-sm); color:var(--text); font-family:inherit;">
        
        <button onclick="attemptLogin()" class="btn btn-primary" style="margin-top:8px;">Sign in</button>
        <button onclick="signUpInstead()" class="btn btn-secondary">Create free account</button>
        <button onclick="closeLoginModal()" class="btn btn-ghost" style="margin-top:12px;">Maybe later</button>
      </div>
      
      <p id="login-error" style="color:var(--error); font-size:12px; margin-top:12px; display:none;">Invalid email or password.</p>
    </div>
  </div>

  <!-- Sample Report Disclaimer Modal -->
  <div id="sample-disclaimer-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:9999; align-items:center; justify-content:center;">
    <div style="background:var(--bg1); border:1px solid var(--border); border-radius:var(--radius); padding:32px; max-width:520px; width:90%;">
      <h3 style="margin-bottom:12px;font-family:'Inter Tight';font-weight:700;">Sample TVI Report</h3>
      
      <p style="color:var(--text-2); font-size:14px; line-height:1.6; margin-bottom:16px;">
        These reports are sample outputs generated by the BoonMind Temporal Validation framework.
        They show the format, depth, and analytical structure of TVI reports.
      </p>
      
      <div style="background:var(--accent-dim);border-left:3px solid var(--accent);padding:12px 16px;border-radius:0 8px 8px 0;margin-bottom:16px;">
        <p style="font-size:13px;font-weight:600;margin-bottom:8px;">Custom TVI reports include:</p>
        <ul style="margin:0;padding-left:18px;font-size:13px;color:var(--text-2);line-height:1.6;">
          <li>Live data ingestion</li>
          <li>Competitive sets</li>
          <li>Scenario modeling</li>
          <li>Sensitivity analysis</li>
          <li>Domain-specific tuning</li>
        </ul>
      </div>
      
      <p style="font-size:12px;color:var(--text-3);font-style:italic;margin-bottom:20px;">
        This example is provided for demonstration and evaluation purposes only.
      </p>
      
      <div style="display:flex;gap:10px;">
        <button id="proceed-download-btn" class="btn btn-primary" style="flex:1;">Download Sample</button>
        <button onclick="closeSampleDisclaimer()" class="btn btn-secondary" style="flex:1;">Cancel</button>
      </div>
    </div>
  </div>
</body>
</html>
